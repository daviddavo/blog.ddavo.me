<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Computing information retrieval metrics in Pytorch Geometric | David Dav贸</title>
<meta name=keywords content="precision,pytorch,pytorch geometric,recall"><meta name=description content="How to calculate metrics like precision@k, recall@k and r-precision for information retrieval and recommender systems in PyTorch Geometric"><meta name=author content><link rel=canonical href=https://blog.ddavo.me/posts/pytorch-geometric-metrics/><link crossorigin=anonymous href=/assets/css/stylesheet.min.95a0dc4d902cdc9618d330d0711e4d270392892cade17415d3b1679dfaac418e.css integrity="sha256-laDcTZAs3JYY0zDQcR5NJwOSiSyt4XQV07FnnfqsQY4=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.ddavo.me/favicon.ico><link rel=apple-touch-icon href=https://blog.ddavo.me/apple-touch-icon.png><link rel=alternate hreflang=en href=https://blog.ddavo.me/posts/pytorch-geometric-metrics/><meta name=twitter:title content="Computing information retrieval metrics in Pytorch Geometric | David Dav贸"><meta name=twitter:description content="How to calculate metrics like precision@k, recall@k and r-precision for information retrieval and recommender systems in PyTorch Geometric"><meta property="og:title" content="Computing information retrieval metrics in Pytorch Geometric | David Dav贸"><meta property="og:description" content="How to calculate metrics like precision@k, recall@k and r-precision for information retrieval and recommender systems in PyTorch Geometric"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.ddavo.me/posts/pytorch-geometric-metrics/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-04T18:21:50+00:00"><meta property="article:modified_time" content="2024-08-04T18:17:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.ddavo.me/posts/"},{"@type":"ListItem","position":2,"name":"Computing information retrieval metrics in Pytorch Geometric","item":"https://blog.ddavo.me/posts/pytorch-geometric-metrics/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Computing information retrieval metrics in Pytorch Geometric | David Dav贸","name":"Computing information retrieval metrics in Pytorch Geometric","description":"How to calculate metrics like precision@k, recall@k and r-precision for information retrieval and recommender systems in PyTorch Geometric","keywords":["precision","pytorch","pytorch geometric","recall"],"wordCount":"641","inLanguage":"en","datePublished":"2023-08-04T18:21:50.04Z","dateModified":"2024-08-04T18:17:00.602Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.ddavo.me/posts/pytorch-geometric-metrics/"},"publisher":{"@type":"Organization","name":"David Dav贸's dev log","logo":{"@type":"ImageObject","url":"https://blog.ddavo.me/favicon.ico"}}}</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//matomo.ddavo.me/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","4"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script><script type=text/javascript src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary-bg:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list-page{background:var(--theme)}.list-page:not(.dark)::-webkit-scrollbar-track{background:0 0}.list-page:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript></head><body class="type-default kind-page layout-" id=top><script data-no-instant>function switchTheme(e){switch(e){case"light":document.body.classList.remove("dark");break;case"dark":document.body.classList.add("dark");break;default:window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")}}function isDarkTheme(){return document.body.className.includes("dark")}function getPrefTheme(){return localStorage.getItem("pref-theme")}function setPrefTheme(e){switchTheme(e),localStorage.setItem("pref-theme",e)}const toggleThemeCallbacks={};toggleThemeCallbacks.main=e=>{setPrefTheme(e?"light":"dark")},window.addEventListener("toggle-theme",function(){const e=isDarkTheme();for(const t in toggleThemeCallbacks)toggleThemeCallbacks[t](e)});function toggleThemeListener(){window.dispatchEvent(new CustomEvent("toggle-theme"))}</script><script>(function(){const t="light",e=getPrefTheme(),n=e||t;switchTheme(n)})()</script><header class=header><nav class=nav><div class=logo><a href=https://blog.ddavo.me/ accesskey=h title="David Dav贸's dev log (Alt + H)">David Dav贸's dev log</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://blog.ddavo.me/es/ title=" Espa帽ol" aria-label=":es: Espa帽ol"> Espa帽ol</a></li></ul></span></div><ul id=menu></ul></nav></header><main class="main post"><article class=post-single><header class=post-header><h1 class=post-title>Computing information retrieval metrics in Pytorch Geometric</h1><div class=post-description>How to calculate metrics like precision@k, recall@k and r-precision for information retrieval and recommender systems in PyTorch Geometric</div><div class=post-meta><span class=meta-item><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg>
<span>2023-08-04</span></span><span class=meta-item>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon" style="user-select:text"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z" style="user-select:text"/><line x1="7" y1="7" x2="7" y2="7" style="user-select:text"/></svg>
<span class=post-tags><a href=https://blog.ddavo.me/tags/artificial-intelligence/>Artificial Intelligence</a><a href=https://blog.ddavo.me/tags/pytorch/>PyTorch</a><a href=https://blog.ddavo.me/tags/python/>Python</a></span></span><span class=meta-item>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg>
<span>641 words</span></span><span class=meta-item>
<svg width="24" height="24" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>4 min</span></span></div></header><div class=post-content><h2 id=formulas-and-definitions>Formulas and Definitions<a hidden class=anchor aria-hidden=true href=#formulas-and-definitions>露</a></h2><p>There are multiple metrics used both in information retrieval and recommender systems that are analagous to standard metrics. Precision and recall at k (also called precision@k and recall@k) both answer the simple question of &ldquo;whats the precision/recall if I retrieve k documents using my system&rdquo;.</p><blockquote><p>$$ p@k = \frac{|\{\text{relevant documents}\}\cap\{\text{top k retrieved documents}\}|}{k} $$</p></blockquote><p>But with both of these metrics, the constant <em>k</em> needs to be known. A user that only interacted 3 times with items will have a maximum p@5 of 3/5, but for a user with hundreds of interactions, scoring a good p@5 would be too easy for our system. Furthermore, if you have hundreds of interactions for every user, the recall will be pretty low.</p><p>If we could just vary the <em>k</em> for each user&mldr; Thats when R-precission comes in handy. Is like precision@k, but the k is different for each user, and is equal to the number of relevant items for the user. The difference between the old simple recall and r-precision is that the number of documents to retrieve is equal to the number of relevant documents.</p><blockquote><p>$$ r-precision = \frac{\left|\{\text{relevant documents}\}\cap \{\text{top R retrieved documents}\}\right| }{R} $$</p><p>Where \(R = |\{\text{relevant documents}\}|\)</p></blockquote><h2 id=implementation-and-pytorch-geometric-code>Implementation and PyTorch Geometric code<a hidden class=anchor aria-hidden=true href=#implementation-and-pytorch-geometric-code>露</a></h2><p>Let&rsquo;s imagine the graph is implemented as a tensor <code>edge_index</code> of size <code>[2,n_users]</code>, where <code>edge_index[0]</code> is the source of each edge, and <code>edge_index[1]</code> is the destination. We also have a model with a method <code>model.recommend</code> (like <a href="https://pytorch-geometric.readthedocs.io/en/latest/generated/torch_geometric.nn.models.LightGCN.html?highlight=lightgcn">LightGCN</a>), that, given a value <em>k</em> returns the top <em>k</em> recommendations of nodes.</p><p>The code of the following function is thoroughly commented to make it easier to understand. It receives a k and returns both the precision and recall at k, and the R-precision.</p><p>I assume that the model and the graph are out of the scope of the function (they are global variables, or this functions is inside a bigger function).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@torch.no_grad</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>prec_rec</span><span class=p>(</span><span class=n>k</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># gt: ground truth (all edges)</span>
</span></span><span class=line><span class=cl>    <span class=n>gt_index</span> <span class=o>=</span> <span class=n>original</span><span class=p>[</span><span class=s1>&#39;voter&#39;</span><span class=p>,</span> <span class=s1>&#39;votes&#39;</span><span class=p>,</span> <span class=s1>&#39;proposal&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>edge_index</span>
</span></span><span class=line><span class=cl>    <span class=n>edge_index</span> <span class=o>=</span> <span class=n>validation</span><span class=p>[</span><span class=s1>&#39;voter&#39;</span><span class=p>,</span> <span class=s1>&#39;votes&#39;</span><span class=p>,</span> <span class=s1>&#39;proposal&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>edge_index</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># First, we will need to obtain the R value for each node</span>
</span></span><span class=line><span class=cl>    <span class=c1># In graph terms, this is just the degree of the graph</span>
</span></span><span class=line><span class=cl>    <span class=c1># (the number of items each user interacted with)</span>
</span></span><span class=line><span class=cl>    <span class=n>R</span> <span class=o>=</span> <span class=n>item_count</span> <span class=o>=</span> <span class=n>PyG</span><span class=o>.</span><span class=n>utils</span><span class=o>.</span><span class=n>degree</span><span class=p>(</span><span class=n>gt_index</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>num_nodes</span><span class=o>=</span><span class=n>n_users</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># Then, we get the top max(R) recomendations. This is a bit</span>
</span></span><span class=line><span class=cl>    <span class=c1># expensive but less than sorting all the recommendations</span>
</span></span><span class=line><span class=cl>    <span class=n>topr</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>recommend</span><span class=p>(</span><span class=n>edge_index</span><span class=p>,</span> <span class=n>src_index</span><span class=o>=</span><span class=n>users</span><span class=p>,</span> <span class=n>dst_index</span><span class=o>=</span><span class=n>items</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=nb>int</span><span class=p>(</span><span class=n>R</span><span class=o>.</span><span class=n>max</span><span class=p>()),</span> <span class=nb>sorted</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># We transform the pair of vertices format to a </span>
</span></span><span class=line><span class=cl>    <span class=c1># bipartite adjacency matrix</span>
</span></span><span class=line><span class=cl>    <span class=n>ground_truth</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>full</span><span class=p>((</span><span class=n>n_users</span><span class=p>,</span> <span class=n>n_items</span><span class=p>),</span> <span class=kc>False</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>torch</span><span class=o>.</span><span class=n>bool</span><span class=p>,</span> <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ground_truth</span><span class=p>[</span><span class=n>gt_index</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>gt_index</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>n_users</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Then, we gather the results of that matrix using</span>
</span></span><span class=line><span class=cl>    <span class=c1># the top recommendations obtained before</span>
</span></span><span class=line><span class=cl>    <span class=n>isin_rmat</span> <span class=o>=</span> <span class=n>ground_truth</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>topr</span> <span class=o>-</span> <span class=n>n_users</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># For p@k and r@k we just need the first k recommendations</span>
</span></span><span class=line><span class=cl>    <span class=n>isin_mat</span> <span class=o>=</span> <span class=n>isin_rmat</span><span class=p>[:,</span> <span class=p>:</span><span class=n>k</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># We calculate mean precision and recall using the formulas</span>
</span></span><span class=line><span class=cl>    <span class=n>prec</span> <span class=o>=</span> <span class=p>(</span><span class=n>isin_mat</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dim</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span> <span class=o>/</span> <span class=n>k</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=n>n_users</span>
</span></span><span class=line><span class=cl>    <span class=n>rec</span> <span class=o>=</span> <span class=p>(</span><span class=n>isin_mat</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dim</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span> <span class=o>/</span> <span class=n>item_count</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=n>n_users</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># We can&#39;t do isin_rmat[:, :R] because R is not an scalar</span>
</span></span><span class=line><span class=cl>    <span class=c1># My solution is to create a mask with as much ones as R</span>
</span></span><span class=line><span class=cl>    <span class=n>msk</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>R</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>R</span><span class=o>.</span><span class=n>unsqueeze</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>isin_rmat</span><span class=p>[</span><span class=n>msk</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=c1># Calculate the mean R-precision using the formula</span>
</span></span><span class=line><span class=cl>    <span class=n>rprec</span> <span class=o>=</span> <span class=p>(</span><span class=n>isin_rmat</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dim</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span> <span class=o>/</span> <span class=n>R</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=n>n_users</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Finally, we convert the 1-d one item tensors to float</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=n>prec</span><span class=p>),</span> <span class=nb>float</span><span class=p>(</span><span class=n>rec</span><span class=p>),</span> <span class=nb>float</span><span class=p>(</span><span class=n>rprec</span><span class=p>)</span>
</span></span></code></pre></div><p>Even if you don&rsquo;t use PyTorch Geometric and you prefer other library, the code should be useful. Just accomodate the edge index and create a similar recommend method and you will be able to calculate r-precision.</p><h2 id=sources-and-more-information>Sources and more information<a hidden class=anchor aria-hidden=true href=#sources-and-more-information>露</a></h2><ul><li><a href=https://pytorch-geometric.readthedocs.io/en/latest/>PyTorch Geometric - Read The Docs</a></li><li><a href=https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Precision_at_k>Wikipedia - Evaluation measures (information retrieval)</a></li><li><a href=https://stackoverflow.com/questions/76837716/how-to-slice-a-2d-tensor-using-a-1d-tensor-instead-of-scalar>StackOverflow - How to slice a 2D tensor using a 1D tensor instead of scalar</a></li><li><a href=https://discuss.pytorch.org/t/how-to-use-a-1d-tensor-as-an-index-to-slice-a-2d-tensor/185736>PyTorch Forums - How to use a 1d tensor as an index to slice a 2d tensor</a></li></ul></div><footer class=post-footer><div class=author-bio id=author-ddavo><img class=author-photo src=https://ddavo.me/images/perfil_huba47176c86c69447ba79fdf42134ec50_849216_200x200_fit_box_3.png alt><div class=author-social><a href=https://www.linkedin.com/in/ddavo/ target=_blank><svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 448 512" width="1em"><path d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</a><a href=https://github.com/daviddavo target=_blank><svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 496 512" width="1em"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</a><a href=https://stackoverflow.com/users/4505998/david-dav%c3%b3 target=_blank><svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 384 512" width="1em"><path d="M290.7 311 95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 3e2zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-2e2v39.7h2e2zm39.7 80H42.7V320h-40v160h359.5V320h-40z"/></svg>
</a><a href=https://www.kaggle.com/daviddavo target=_blank><svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 320 512" width="1em"><path d="M304.2 501.5 158.4 320.3 298.2 185c2.6-2.7 1.7-10.5-5.3-10.5h-69.2c-3.5.0-7 1.8-10.5 5.3L80.9 313.5V7.5q0-7.5-7.5-7.5H21.5Q14 0 14 7.5v497q0 7.5 7.5 7.5h51.9q7.5.0 7.5-7.5v-109l30.8-29.3 110.5 140.6c3 3.5 6.5 5.3 10.5 5.3h66.9q5.25.0 6-3z"/></svg>
</a><a href=https://orcid.org/0000-0003-1744-8314 target=_blank><svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 512 512" width="1em"><path d="M294.75 188.19h-45.92V342h47.47c67.62.0 83.12-51.34 83.12-76.91.0-41.64-26.54-76.9-84.67-76.9zM256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm-80.79 360.76h-29.84v-207.5h29.84zm-14.92-231.14a19.57 19.57.0 1119.57-19.57 19.64 19.64.0 01-19.57 19.57zM3e2 369h-81V161.26h80.6c76.73.0 110.44 54.83 110.44 103.85C410 318.39 368.38 369 3e2 369z"/></svg>
</a><a href="https://scholar.google.com/citations?user=LNSSvv4AAAAJ" target=_blank><svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 512 512" width="1em"><path d="M390.9 298.5s0 .1.1.1c9.2 19.4 14.4 41.1 14.4 64C405.3 445.1 338.5 512 256 512s-149.3-66.9-149.3-149.3c0-22.9 5.2-44.6 14.4-64h0c1.7-3.6 3.6-7.2 5.6-10.7 4.4-7.6 9.4-14.7 15-21.3 27.4-32.6 68.5-53.3 114.4-53.3 33.6.0 64.6 11.1 89.6 29.9 9.1 6.9 17.4 14.7 24.8 23.5 5.6 6.6 10.6 13.8 15 21.3 2 3.4 3.8 7 5.5 10.5zm26.4-18.8c-30.1-58.4-91-98.4-161.3-98.4s-131.2 40-161.3 98.4L0 202.7 256 0 512 202.7l-94.7 77.1z"/></svg></a></div><div class=author-details><div class=author-name>About David Dav贸</div><div class=author-occupation>Research Assistant @ Complutense University of Madrid</div><div class=author-contact><a href=https://ddavo.me target=_blank><svg aria-hidden="true" class="hi-svg-inline" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
ddavo.me
</a><a href=mailto:david@ddavo.me><svg aria-hidden="true" class="hi-svg-inline" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
david@ddavo.me</a></div><div class=author-description><p>Research assistant that just finished its Masters in Artificial Intelligence at the Politechnic University of Madrid.
Researching about online communities in blockchain at the Complutense University of Madrid since 2021. In 2022 I received the BsC in Computer Science at that same university, and in 2024 a MsC in Artificial Intelligence at the Politechnic University of Madrid.</p></div></div></div></footer><div class=comments-separator></div><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script><link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><div id=comment-section></div><script>initComments({node:document.getElementById("comment-section"),defaultHomeserverUrl:"https://matrix.cactus.chat:8448",serverName:"cactus.chat",siteName:"blog.ddavo.me",commentSectionId:"/posts/pytorch-geometric-metrics/"})</script></article></main><footer class=footer><span>漏 David Dav贸 2015 - 2024</span><span style=display:inline-block;margin-left:1em>
<a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA</a>
</span><span style=display:inline-block;margin-left:1em>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
    <a href=https://github.com/reorx/hugo-PaperModX/ rel=noopener target=_blank>PaperModX</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>(function(){const t=""=="1";if(t)return;let e=document.getElementById("theme-toggle");e.removeEventListener("click",toggleThemeListener),e.addEventListener("click",toggleThemeListener)})()</script><script>(function(){let e=document.getElementById("menu");e&&(e.scrollLeft=localStorage.getItem("menu-scroll-position"),e.onscroll=function(){localStorage.setItem("menu-scroll-position",e.scrollLeft)});const t=""=="1",n=""=="1";if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||t||n)return;document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})})()</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>if(window.scrollListeners)for(const e of scrollListeners)window.removeEventListener("scroll",e);window.scrollListeners=[]</script><script src=/js/medium-zoom.min.js data-no-instant></script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>(function(){const a=""=="1";if(!a)return;if(!document.querySelector(".toc")){console.log("no toc found, ignore toc scroll");return}const r=window.scrollListeners,t=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id]"),n="active";let e=t[0];o(e).classList.add(n);const c=()=>{const s=[];for(const e of t)if(l(e)<5)s.push(e);else break;s.length>0?newActiveHeading=s[s.length-1]:newActiveHeading=t[0],e!=newActiveHeading&&(o(e).classList.remove(n),e=newActiveHeading,o(e).classList.add(n))};let s=null;const i=()=>{s!==null&&clearTimeout(s),s=setTimeout(c,50)};window.addEventListener("scroll",i,!1),r.push(i);function o(e){const t=encodeURI(e.getAttribute("id")).toLowerCase();return document.querySelector(`.toc ul li a[href="#${t}"]`)}function l(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect();return t.top}})()</script></body></html>