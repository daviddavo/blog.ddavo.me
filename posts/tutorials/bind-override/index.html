<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How to override some domain names in your local network | David Davó</title>
<meta name=keywords content="lan,local network,domain name"><meta name=description content="In this tutorial you will learn how to override some domain names in your local network configuring a Response Policy Zone in the bind9 server"><meta name=author content><link rel=canonical href=https://blog.ddavo.me/posts/tutorials/bind-override/><link crossorigin=anonymous href=/assets/css/stylesheet.min.95a0dc4d902cdc9618d330d0711e4d270392892cade17415d3b1679dfaac418e.css integrity="sha256-laDcTZAs3JYY0zDQcR5NJwOSiSyt4XQV07FnnfqsQY4=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.ddavo.me/favicon.ico><link rel=apple-touch-icon href=https://blog.ddavo.me/apple-touch-icon.png><link rel=alternate hreflang=en href=https://blog.ddavo.me/posts/tutorials/bind-override/><link rel=alternate hreflang=es href=https://blog.ddavo.me/es/posts/tutorials/bind-override/><meta name=twitter:title content="How to override some domain names in your local network | David Davó"><meta name=twitter:description content="In this tutorial you will learn how to override some domain names in your local network configuring a Response Policy Zone in the bind9 server"><meta property="og:title" content="How to override some domain names in your local network | David Davó"><meta property="og:description" content="In this tutorial you will learn how to override some domain names in your local network configuring a Response Policy Zone in the bind9 server"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.ddavo.me/posts/tutorials/bind-override/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-12-22T13:17:17+01:00"><meta property="article:modified_time" content="2024-08-04T18:17:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.ddavo.me/posts/"},{"@type":"ListItem","position":2,"name":"How to override some domain names in your local network","item":"https://blog.ddavo.me/posts/tutorials/bind-override/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to override some domain names in your local network | David Davó","name":"How to override some domain names in your local network","description":"In this tutorial you will learn how to override some domain names in your local network configuring a Response Policy Zone in the bind9 server","keywords":["lan","local network","domain name"],"wordCount":"1146","inLanguage":"en","datePublished":"2021-12-22T13:17:17+01:00","dateModified":"2024-08-04T18:17:00.646Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.ddavo.me/posts/tutorials/bind-override/"},"publisher":{"@type":"Organization","name":"David Davó's dev log","logo":{"@type":"ImageObject","url":"https://blog.ddavo.me/favicon.ico"}}}</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//matomo.ddavo.me/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","4"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary-bg:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list-page{background:var(--theme)}.list-page:not(.dark)::-webkit-scrollbar-track{background:0 0}.list-page:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript></head><body class="type-posts kind-page layout-" id=top><script data-no-instant>function switchTheme(e){switch(e){case"light":document.body.classList.remove("dark");break;case"dark":document.body.classList.add("dark");break;default:window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")}}function isDarkTheme(){return document.body.className.includes("dark")}function getPrefTheme(){return localStorage.getItem("pref-theme")}function setPrefTheme(e){switchTheme(e),localStorage.setItem("pref-theme",e)}const toggleThemeCallbacks={};toggleThemeCallbacks.main=e=>{setPrefTheme(e?"light":"dark")},window.addEventListener("toggle-theme",function(){const e=isDarkTheme();for(const t in toggleThemeCallbacks)toggleThemeCallbacks[t](e)});function toggleThemeListener(){window.dispatchEvent(new CustomEvent("toggle-theme"))}</script><script>(function(){const t="light",e=getPrefTheme(),n=e||t;switchTheme(n)})()</script><header class=header><nav class=nav><div class=logo><a href=https://blog.ddavo.me/ accesskey=h title="David Davó's dev log (Alt + H)">David Davó's dev log</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://blog.ddavo.me/es/ title="🇪🇸 Español" aria-label=":es: Español">🇪🇸 Español</a></li></ul></span></div><ul id=menu></ul></nav></header><main class="main post"><article class=post-single><header class=post-header><h1 class=post-title>How to override some domain names in your local network</h1><div class=post-description>In this tutorial you will learn how to override some domain names in your local network configuring a Response Policy Zone in the bind9 server</div><div class=post-meta><span class=meta-item><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg>
<span>2021-12-22</span></span><span class=meta-item>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon" style="user-select:text"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z" style="user-select:text"/><line x1="7" y1="7" x2="7" y2="7" style="user-select:text"/></svg>
<span class=post-tags><a href=https://blog.ddavo.me/tags/tutorial/>Tutorial</a><a href=https://blog.ddavo.me/tags/dns/>Dns</a><a href=https://blog.ddavo.me/tags/self-hosting/>Self-Hosting</a><a href=https://blog.ddavo.me/tags/homelab/>Homelab</a></span></span><span class=meta-item>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg>
<span>1146 words</span></span><span class=meta-item>
<svg width="24" height="24" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>6 min</span></span><span class=meta-item>
<svg viewBox="0 0 24 24" width="24" height="24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M7 4c0 4.846.0 7 .5 8"/><path d="M10 8.5c0 2.286-2 4.5-3.5 4.5S4 11.865 4 11c0-2 1-3 3-3s5 .57 5 2.857c0 1.524-.667 2.571-2 3.143"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<span class=i18n-links><a href=https://blog.ddavo.me/es/posts/tutorials/bind-override/>🇪🇸 Español</a></span></span></div></header><div class="toc side left"><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#bind-the-ubiquitous-domain-name-system-server aria-label="BIND: The ubiquitous Domain Name System server">BIND: The ubiquitous Domain Name System server</a></li><li><a href=#installing-bind aria-label="Installing BIND">Installing BIND</a></li><li><a href=#bind-configuration-for-your-local-network aria-label="BIND configuration for your local network">BIND configuration for your local network</a><ul><li><a href=#starting-the-dns-server aria-label="Starting the DNS server">Starting the DNS server</a></li><li><a href=#using-the-dns-server aria-label="Using the DNS server">Using the DNS server</a></li></ul></li><li><a href=#sources--more-information aria-label="Sources &amp;amp; more information">Sources & more information</a></li></ul></div></details></div><div class=post-content><p>If you have a small home local network, perhaps you&rsquo;ve had problems accessing your domain names.
As you may already know, in your home network you have a public IP (given by your ISP) and a set of private or local IP addresses used among your devices in your local network.
The technology that allows mapping a lot of private addresses to a unique public address is called masquerading or Network Address Translation (NAT).</p><p>Issues arise when you use a DNS to assign a domain name to a service. For example, let&rsquo;s say you have a blog, and you want to map the domain <code>blog.example.com</code> to the public IP <code>1.2.3.4</code>. In your router, you do a port mapping to the device with a local address <code>192.168.1.66</code>. But when you want to access <code>blog.example.com</code> in your web browser inside your local network&mldr; it doesn&rsquo;t work! It says something along the lines of &ldquo;Unable to connect to the host&rdquo; &ndash; but the host is just right THERE! &ndash;.
The thing is, your computer is trying to connect to <code>1.2.3.4</code> (the address resolved by the DNS), when what you really want is to connect to <code>192.168.1.66</code> (your local address). You could modify the <code>/etc/hosts</code> file in every device in your home, but there&rsquo;s an alternative: hosting your own DNS.</p><blockquote><p>Requirements before reading this post</p><ul><li>Knowing what is DNS and how to change the records in your registrar</li></ul></blockquote><h2 id=bind-the-ubiquitous-domain-name-system-server>BIND: The ubiquitous Domain Name System server<a hidden class=anchor aria-hidden=true href=#bind-the-ubiquitous-domain-name-system-server>¶</a></h2><p>With the Domain Name System, you ask a Domain Name server for the IP associated to a Domain Name. I&rsquo;m pretty sure that you already have a bind system in your home without you knowing it, your ISP given router. In fact, having a DNS server in your LAN has a lot of advantages, because you are querying a device located 10 meters from you, instead of a server hundreds of kilometers from you.</p><p>To override some records we can use a <em>Response Policy Zone</em> (RPZ), which allows us to override some domain name mappings inside our local network.</p><p>Let&rsquo;s see how to set up everything</p><h2 id=installing-bind>Installing BIND<a hidden class=anchor aria-hidden=true href=#installing-bind>¶</a></h2><p>Depending on your Linux distro or your operating system, the installing process (and the files to modify) may vary. In this tutorial, we use a machine with Debian/Ubuntu. We just need to install a couple of packages, using the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=gp>$</span> sudo apt install bind9 bind9utils bind9-doc
</span></span></code></pre></div><h2 id=bind-configuration-for-your-local-network>BIND configuration for your local network<a hidden class=anchor aria-hidden=true href=#bind-configuration-for-your-local-network>¶</a></h2><blockquote><p>Remember: To be able to modify these file you&rsquo;ll need to be root or use <code>sudo</code></p></blockquote><p>First, we need to set up a new zone to add our subdomains, we are going to call it &ldquo;rpz&rdquo;, and we&rsquo;ll set its DNS database at <code>/etc/bind/db.rpz</code>. We&rsquo;ll edit the file <code>/etc/bind/named.conf.default-zones</code> and add the following lines:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>zone &#34;rpz&#34; {
</span></span><span class=line><span class=cl>    type master;
</span></span><span class=line><span class=cl>    file &#34;/etc/bind/db.rpz&#34;;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>Now, we add our records to the database (<code>/etc/bind/db.rpz</code>)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dns data-lang=dns><span class=line><span class=cl><span class=c>; Our LAN records</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=na>$TTL</span><span class=w> </span><span class=sc>3600</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>; These two records specify which is the DNS for this zone</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nc>@</span><span class=w>		</span><span class=k>IN</span><span class=w>	</span><span class=k>SOA</span><span class=w>	</span><span class=py>localhost. root.localhost. </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			      </span><span class=sc>2</span><span class=w>		</span><span class=c>; Serial</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			 </span><span class=sc>604800</span><span class=w>		</span><span class=c>; Refresh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			  </span><span class=sc>86400</span><span class=w>		</span><span class=c>; Retry</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=sc>2419200</span><span class=w>		</span><span class=c>; Expire</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			 </span><span class=sc>604800</span><span class=w> </span><span class=p>)</span><span class=w>	</span><span class=c>; Negative Cache TTL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nc>@</span><span class=w>		</span><span class=k>IN</span><span class=w>	</span><span class=k>NS</span><span class=w>	</span><span class=py>localhost.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>; Using $ORIGIN we can add only the subdomain and not the full domain</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=na>$ORIGIN</span><span class=w> </span><span class=nc>example.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nc>nas</span><span class=w>                  </span><span class=k>A</span><span class=w>       </span><span class=mi>192.168.1.42</span><span class=w>              </span><span class=c>; IPv4 address of nas.example.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nc>nas</span><span class=w>                  </span><span class=k>AAAA</span><span class=w>    </span><span class=il>fe80::1ff:fe23:4567:890a</span><span class=w>  </span><span class=c>; IPv6 address of nas.example.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nc>ftp</span><span class=w>                  </span><span class=k>CNAME</span><span class=w>   </span><span class=err>nas</span><span class=w>                       </span><span class=c>; Un simple alias of ftp.example.com a nas.example.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=py>blog.example2.org. </span><span class=w>  </span><span class=k>A</span><span class=w>       </span><span class=mi>192.168.1.31</span><span class=w>              </span><span class=c>; We can also add fully qualified domain names</span><span class=w>
</span></span></span></code></pre></div><p>But we need to tell the DNS to ask for the records (domain name) it doesn&rsquo;t have in its database to another server. For this, we need to enable <em>recursion</em> and to specify the upstream servers to ask when we don&rsquo;t have the record in our RPZ.</p><blockquote><p>The forwarders servers can be given by your ISP, or your local router (192.168.1.1), but I recommend using Google&rsquo;s or Cloudflare&rsquo;s DNS servers because of their reliability and speed.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>options</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=n>directory</span> <span class=s2>&#34;/var/cache/bind&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>recursion</span> <span class=n>yes</span><span class=p>;</span> <span class=c1># Enabling recursion</span>
</span></span><span class=line><span class=cl>	<span class=n>listen</span><span class=o>-</span><span class=n>on</span> <span class=p>{</span> <span class=mf>192.168</span><span class=o>.</span><span class=mf>1.11</span><span class=p>;</span> <span class=p>};</span> <span class=c1># The IP address of THIS DNS server</span>
</span></span><span class=line><span class=cl>	<span class=c1># You can set it to any if you want it to listen to petitions</span>
</span></span><span class=line><span class=cl>	<span class=c1># from outside</span>
</span></span><span class=line><span class=cl>	<span class=n>allow</span><span class=o>-</span><span class=n>transfer</span> <span class=p>{</span> <span class=n>none</span><span class=p>;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>	<span class=n>response</span><span class=o>-</span><span class=n>policy</span> <span class=p>{</span> <span class=n>zone</span> <span class=s2>&#34;rpz&#34;</span><span class=p>;</span> <span class=p>}</span> <span class=k>break</span><span class=o>-</span><span class=n>dnssec</span> <span class=n>yes</span><span class=p>;</span> <span class=c1># The response policy zone name</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>forwarders</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=mf>8.8</span><span class=o>.</span><span class=mf>8.8</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=mf>8.8</span><span class=o>.</span><span class=mf>4.4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=mf>1.1</span><span class=o>.</span><span class=mf>1.1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>dnssec</span><span class=o>-</span><span class=n>validation</span> <span class=n>auto</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>listen</span><span class=o>-</span><span class=n>on</span><span class=o>-</span><span class=n>v6</span> <span class=p>{</span> <span class=n>any</span><span class=p>;</span> <span class=p>};</span> <span class=c1># You can set it to &#34;none&#34; if you don&#39;t want to use IPv6 DNS</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><blockquote><p>It is important to tell the server to ignore dnssec requests.
If we don&rsquo;t do that, the server could reply with a signed response, but with
an incorrect (outside) address.</p></blockquote><blockquote><p>It is important to tell the server to ignore dnssec requests.
If we don&rsquo;t do that, the server could reply with a signed response, but with
an incorrect (outside) address.</p></blockquote><h3 id=starting-the-dns-server>Starting the DNS server<a hidden class=anchor aria-hidden=true href=#starting-the-dns-server>¶</a></h3><p>To apply the changes, we start the server using systemctl</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=gp>$</span> sudo systemctl <span class=nb>enable</span> --now bind9
</span></span></code></pre></div><p>We can check whether it works using <code>dig</code> (perhaps you need to install it first),
which allows us to make queries to a given DNS server instead of using the default.</p><p>First, we check if usual queries work, like google.com</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=gp>$</span> dig google.es
</span></span><span class=line><span class=cl><span class=go>; &lt;&lt;&gt;&gt; DiG 9.16.23 &lt;&lt;&gt;&gt; google.es
</span></span></span><span class=line><span class=cl><span class=go>;; global options: +cmd
</span></span></span><span class=line><span class=cl><span class=go>;; Got answer:
</span></span></span><span class=line><span class=cl><span class=go>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 5016
</span></span></span><span class=line><span class=cl><span class=go>;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>;; OPT PSEUDOSECTION:
</span></span></span><span class=line><span class=cl><span class=go>; EDNS: version: 0, flags:; udp: 4096
</span></span></span><span class=line><span class=cl><span class=go>; COOKIE: 01db1f47a27adb9e90e4c7fb61c24bc2bf8c6a88296c3923 (good)
</span></span></span><span class=line><span class=cl><span class=go>;; QUESTION SECTION:
</span></span></span><span class=line><span class=cl><span class=go>;google.es.			IN	A
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>;; ANSWER SECTION:
</span></span></span><span class=line><span class=cl><span class=go>google.es.		300	IN	A	142.250.200.131
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>;; Query time: 39 msec
</span></span></span><span class=line><span class=cl><span class=go>;; SERVER: 192.168.1.11#53(192.168.1.11)
</span></span></span><span class=line><span class=cl><span class=go>;; WHEN: Tue Dec 21 22:48:50 CET 2021
</span></span></span><span class=line><span class=cl><span class=go>;; MSG SIZE  rcvd: 82
</span></span></span></code></pre></div><p>Now we check that our RPZ works</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=gp>$</span> dig chikyuu.ddavo.me @192.168.1.11
</span></span><span class=line><span class=cl><span class=go>; &lt;&lt;&gt;&gt; DiG 9.16.23 &lt;&lt;&gt;&gt; nas.example.com
</span></span></span><span class=line><span class=cl><span class=go>;; global options: +cmd
</span></span></span><span class=line><span class=cl><span class=go>;; Got answer:
</span></span></span><span class=line><span class=cl><span class=go>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 45881
</span></span></span><span class=line><span class=cl><span class=go>;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>;; OPT PSEUDOSECTION:
</span></span></span><span class=line><span class=cl><span class=go>; EDNS: version: 0, flags:; udp: 4096
</span></span></span><span class=line><span class=cl><span class=go>; COOKIE: d200bc3ba9741e2ab2c8935661c24b4b401d43ae997c39de (good)
</span></span></span><span class=line><span class=cl><span class=go>;; QUESTION SECTION:
</span></span></span><span class=line><span class=cl><span class=go>;nas.example.com.		IN	A
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>;; ANSWER SECTION:
</span></span></span><span class=line><span class=cl><span class=go>nas.example.com.	5	IN	A	192.168.1.42
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>;; Query time: 0 msec
</span></span></span><span class=line><span class=cl><span class=go>;; SERVER: 192.168.1.11#53(192.168.1.11)
</span></span></span><span class=line><span class=cl><span class=go>;; WHEN: Tue Dec 21 22:46:51 CET 2021
</span></span></span><span class=line><span class=cl><span class=go>;; MSG SIZE  rcvd: 89
</span></span></span></code></pre></div><p><strong>It works!!</strong> The returned IP address is the address from our local network, instead of the global one.</p><h3 id=using-the-dns-server>Using the DNS server<a hidden class=anchor aria-hidden=true href=#using-the-dns-server>¶</a></h3><p>Nevertheless, it doesn&rsquo;t work in the web browser, or with any other program apart from <code>dig</code>&mldr;</p><p>We need to set our DNS server as the default DNS in each device. Every device is different, but it shouldn&rsquo;t be very difficult. Perhaps your router can propagate its config using DHCP through the local network!</p><p>If you have any questions, you can let me know in the comments</p><h2 id=sources--more-information>Sources & more information<a hidden class=anchor aria-hidden=true href=#sources--more-information>¶</a></h2><ul><li><a href=https://serverfault.com/questions/18748/overriding-some-dns-entries-in-bind-for-internal-networks>Serverfault.com: Overriding some DNS entries in BIND for internal networks</a></li><li><a href=https://en.wikipedia.org/wiki/Response_policy_zone>Wikipedia: Response policy zone</a></li><li><a href=https://en.wikipedia.org/wiki/Network_address_translation>Wikipedia: Network Address Translation</a></li><li><a href=https://dnsrpz.info/>dnsrpz.info</a></li></ul></div><footer class=post-footer><div class=author-bio id=author-ddavo><img class=author-photo src=https://ddavo.me/images/perfil_huba47176c86c69447ba79fdf42134ec50_849216_200x200_fit_box_3.png alt><div class=author-social><a href=https://www.linkedin.com/in/ddavo/ target=_blank><svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 448 512" width="1em"><path d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</a><a href=https://github.com/daviddavo target=_blank><svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 496 512" width="1em"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</a><a href=https://stackoverflow.com/users/4505998/david-dav%c3%b3 target=_blank><svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 384 512" width="1em"><path d="M290.7 311 95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 3e2zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-2e2v39.7h2e2zm39.7 80H42.7V320h-40v160h359.5V320h-40z"/></svg>
</a><a href=https://www.kaggle.com/daviddavo target=_blank><svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 320 512" width="1em"><path d="M304.2 501.5 158.4 320.3 298.2 185c2.6-2.7 1.7-10.5-5.3-10.5h-69.2c-3.5.0-7 1.8-10.5 5.3L80.9 313.5V7.5q0-7.5-7.5-7.5H21.5Q14 0 14 7.5v497q0 7.5 7.5 7.5h51.9q7.5.0 7.5-7.5v-109l30.8-29.3 110.5 140.6c3 3.5 6.5 5.3 10.5 5.3h66.9q5.25.0 6-3z"/></svg>
</a><a href=https://orcid.org/0000-0003-1744-8314 target=_blank><svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 512 512" width="1em"><path d="M294.75 188.19h-45.92V342h47.47c67.62.0 83.12-51.34 83.12-76.91.0-41.64-26.54-76.9-84.67-76.9zM256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm-80.79 360.76h-29.84v-207.5h29.84zm-14.92-231.14a19.57 19.57.0 1119.57-19.57 19.64 19.64.0 01-19.57 19.57zM3e2 369h-81V161.26h80.6c76.73.0 110.44 54.83 110.44 103.85C410 318.39 368.38 369 3e2 369z"/></svg>
</a><a href="https://scholar.google.com/citations?user=LNSSvv4AAAAJ" target=_blank><svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 512 512" width="1em"><path d="M390.9 298.5s0 .1.1.1c9.2 19.4 14.4 41.1 14.4 64C405.3 445.1 338.5 512 256 512s-149.3-66.9-149.3-149.3c0-22.9 5.2-44.6 14.4-64h0c1.7-3.6 3.6-7.2 5.6-10.7 4.4-7.6 9.4-14.7 15-21.3 27.4-32.6 68.5-53.3 114.4-53.3 33.6.0 64.6 11.1 89.6 29.9 9.1 6.9 17.4 14.7 24.8 23.5 5.6 6.6 10.6 13.8 15 21.3 2 3.4 3.8 7 5.5 10.5zm26.4-18.8c-30.1-58.4-91-98.4-161.3-98.4s-131.2 40-161.3 98.4L0 202.7 256 0 512 202.7l-94.7 77.1z"/></svg></a></div><div class=author-details><div class=author-name>About David Davó</div><div class=author-occupation>Research Assistant @ Complutense University of Madrid</div><div class=author-contact><a href=https://ddavo.me target=_blank><svg aria-hidden="true" class="hi-svg-inline" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
ddavo.me
</a><a href=mailto:david@ddavo.me><svg aria-hidden="true" class="hi-svg-inline" fill="none" height="1em" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1em"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
david@ddavo.me</a></div><div class=author-description><p>Research assistant that just finished its Master’s in Artificial Intelligence at the Politechnic University of Madrid.
Researching about online communities in blockchain at the Complutense University of Madrid since 2021. In 2022 I received the BsC in Computer Science at that same university, and in 2024 a MsC in Artificial Intelligence at the Politechnic University of Madrid.</p></div></div></div></footer><div class=comments-separator></div><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script><link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><div id=comment-section></div><script>initComments({node:document.getElementById("comment-section"),defaultHomeserverUrl:"https://matrix.cactus.chat:8448",serverName:"cactus.chat",siteName:"blog.ddavo.me",commentSectionId:"/posts/tutorials/bind-override/"})</script></article></main><footer class=footer><span>© David Davó 2015 - 2024</span><span style=display:inline-block;margin-left:1em>
<a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA</a>
</span><span style=display:inline-block;margin-left:1em>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
    <a href=https://github.com/reorx/hugo-PaperModX/ rel=noopener target=_blank>PaperModX</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>(function(){const t=""=="1";if(t)return;let e=document.getElementById("theme-toggle");e.removeEventListener("click",toggleThemeListener),e.addEventListener("click",toggleThemeListener)})()</script><script>(function(){let e=document.getElementById("menu");e&&(e.scrollLeft=localStorage.getItem("menu-scroll-position"),e.onscroll=function(){localStorage.setItem("menu-scroll-position",e.scrollLeft)});const t=""=="1",n=""=="1";if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||t||n)return;document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})})()</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>if(window.scrollListeners)for(const e of scrollListeners)window.removeEventListener("scroll",e);window.scrollListeners=[]</script><script src=/js/medium-zoom.min.js data-no-instant></script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>(function(){const a="1"=="1";if(!a)return;if(!document.querySelector(".toc")){console.log("no toc found, ignore toc scroll");return}const r=window.scrollListeners,t=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id]"),n="active";let e=t[0];o(e).classList.add(n);const c=()=>{const s=[];for(const e of t)if(l(e)<5)s.push(e);else break;s.length>0?newActiveHeading=s[s.length-1]:newActiveHeading=t[0],e!=newActiveHeading&&(o(e).classList.remove(n),e=newActiveHeading,o(e).classList.add(n))};let s=null;const i=()=>{s!==null&&clearTimeout(s),s=setTimeout(c,50)};window.addEventListener("scroll",i,!1),r.push(i);function o(e){const t=encodeURI(e.getAttribute("id")).toLowerCase();return document.querySelector(`.toc ul li a[href="#${t}"]`)}function l(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect();return t.top}})()</script></body></html>